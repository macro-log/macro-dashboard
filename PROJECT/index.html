<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SIGNAL 9 | Intelligence Dashboard</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --bg-main: #0a0f1e;
            --bg-card: #161e31;
            --accent: #38bdf8;
            --text-main: #f1f5f9;
            --text-dim: #94a3b8;
            --border: #262f45;
        }

        body { font-family: 'Pretendard', sans-serif; margin: 0; background-color: var(--bg-main); color: var(--text-main); }
        header { padding: 15px 30px; background: var(--bg-card); display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid var(--border); }
        .logo { font-size: 1.6rem; font-weight: 800; color: var(--accent); }
        .main-layout { display: flex; flex-direction: column; padding: 20px; max-width: 1400px; margin: 0 auto; gap: 15px; }

        .nav-group { display: grid; grid-template-columns: repeat(auto-fill, minmax(130px, 1fr)); gap: 8px; }
        button { padding: 12px; cursor: pointer; border: 1px solid var(--border); background: var(--bg-card); color: var(--text-dim); border-radius: 4px; font-weight: 700; font-size: 0.8rem; transition: 0.2s; }
        button:hover { background: var(--accent); color: var(--bg-main); }

        #ticker_container { height: 80px; background: var(--bg-card); border-radius: 8px; border: 1px solid var(--border); overflow: hidden; margin-bottom: 5px; }
        #chart_box { height: 600px; background: var(--bg-card); border-radius: 8px; overflow: hidden; border: 1px solid var(--border); }

        .analysis-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 10px; }
        .card { background: var(--bg-card); padding: 24px; border-radius: 8px; border: 1px solid var(--border); }
        .section-label { color: var(--accent); font-weight: 700; font-size: 0.7rem; text-transform: uppercase; margin-bottom: 10px; display: block; }
        canvas { width: 100% !important; height: 300px !important; }
    </style>
</head>
<body>

    <header>
        <div class="logo">SIGNAL 9</div>
        <div style="font-size: 0.8rem; color: var(--text-dim);">STRATEGIC DATA TERMINAL</div>
    </header>
    
    <div class="main-layout">
        <div class="nav-group">
            <button onclick="changeWidget('BINANCE:BTCUSDT')">비트코인</button>
            <button onclick="changeWidget('FOREXCOM:SPX500')">S&P 500</button>
            <button onclick="changeWidget('FOREXCOM:NAS100')">나스닥 100</button>
            <button onclick="changeWidget('FOREXCOM:DJI')">다우존스</button>
            <button onclick="changeWidget('US10Y')">미국 10년 국채</button>
            <button onclick="changeWidget('US02Y')">미국 2년 국채</button>
            <button onclick="changeWidget('TVC:GOLD')">금</button>
            <button onclick="changeWidget('TVC:USOIL')">유가</button>
        </div>

        <div id="ticker_container"></div>
        <div id="chart_box"></div>

        <div class="analysis-grid">
            <div class="card">
                <span class="section-label">Scenario Chain</span>
                <h3 id="scenario-title">FOMC Minutes Analysis</h3>
                <p id="scenario-content" style="color: var(--text-dim); font-size: 0.95rem;">데이터 로딩 중...</p>
            </div>
            <div class="card">
                <span class="section-label">Keyword Delta</span>
                <h3 id="word-title">Strategic Word Tracking</h3>
                <canvas id="keywordChart"></canvas>
            </div>
        </div>
    </div>

    <script type="text/javascript" src="https://s3.tradingview.com/tv.js"></script>
    <script type="text/javascript">
        // --- TradingView 기능 ---
        function loadTicker(symbol) {
            const container = document.getElementById('ticker_container');
            container.innerHTML = "";
            const script = document.createElement('script');
            script.src = "https://s3.tradingview.com/external-embedding/embed-widget-single-quote.js";
            script.async = true;
            script.innerHTML = JSON.stringify({
                "symbol": symbol,
                "width": "100%",
                "colorTheme": "dark",
                "isTransparent": true,
                "locale": "ko"
            });
            container.appendChild(script);
        }

        function loadChart(symbol) {
            document.getElementById('chart_box').innerHTML = "";
            new TradingView.widget({
                "width": "100%",
                "height": 600,
                "symbol": symbol,
                "interval": "D",
                "timezone": "Asia/Seoul",
                "theme": "dark",
                "style": "1",
                "locale": "ko",
                "toolbar_bg": "#f1f3f6",
                "enable_publishing": false,
                "allow_symbol_change": true,
                "container_id": "chart_box",
                "hide_side_toolbar": false,
                "withdateranges": true,
                "range": "ALL",
                "save_image": false,
                "details": true,
                "hotlist": true,
                "calendar": true,
                "studies": [ "Volume@tv-basicstudies" ],
                "overrides": {
                    "mainSeriesProperties.style": 1,
                    "volumePaneSize": "medium"
                }
            });
        }

        function changeWidget(symbol) {
            loadTicker(symbol);
            loadChart(symbol);
        }

        window.onload = function() { 
            changeWidget('BINANCE:BTCUSDT');
            // --- FOMC 데이터 기능 ---
            fetch('indicators.json')
                .then(response => response.json())
                .then(data => {
                    document.getElementById('scenario-content').innerText = data.scenario;
                    
                    const ctx = document.getElementById('keywordChart').getContext('2d');
                    new Chart(ctx, {
                        type: 'bar',
                        data: {
                            labels: data.keywords.map(k => k.word),
                            datasets: [{
                                label: 'Keywords Delta (%)',
                                data: data.keywords.map(k => parseFloat(k.delta)),
                                backgroundColor: 'rgba(56, 189, 248, 0.5)',
                                borderColor: 'rgba(56, 189, 248, 1)',
                                borderWidth: 1
                            }]
                        }
                    });
                });
        };
    </script>
</body>
</html>